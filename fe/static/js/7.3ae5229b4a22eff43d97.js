webpackJsonp([7],{"/8b3":function(e,t){},lVJ6:function(e,t){},sroI:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Dd8w"),i=n.n(r),o=n("Xxa5"),a=n.n(o),l=n("exGp"),s=n.n(l),c={0:"无效",1:"正常"},u=n("xhV0"),m={props:{visible:{type:Boolean,default:!1},environment:Object},data:function(){return{error:this.initError(),form:this.initForm(),rules:{env_name:[{required:!0,message:"请输入环境名称",trigger:"blur"}]}}},watch:{environment:function(e){if(e){var t=e.env_name;this.form.env_name=t}else this.form=this.initForm()}},computed:{isNew:function(){return!this.environment}},methods:{onOk:function(){var e=this;this.$refs.form.validate(function(t){if(!t)return!1;e.sendData()})},onCancel:function(){this.$emit("update:visible"),this.$emit("close")},initForm:function(){return{env_name:""}},initError:function(){return{env_name:""}},sendData:function(){var e=this;return s()(a.a.mark(function t(){var n,r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.error=e.initError(),t.t0=e.isNew,!t.t0){t.next=6;break}return t.next=6,Object(u.a)(e.form);case 6:if(t.t1=e.isNew,t.t1){t.next=10;break}return t.next=10,Object(u.d)(e.environment.id,i()({},e.form,{status:e.environment.status}));case 10:e.$emit("update:visible"),e.$emit("confirm"),t.next=19;break;case 14:if(t.prev=14,t.t2=t.catch(0),t.t2.code,n=t.t2.message)for(r in n)e.error[r]=n[r][0];case 19:case"end":return t.stop()}},t,e,[[0,14]])}))()}}},d={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{staticClass:"wl-add-environment",attrs:{width:"600px",title:e.isNew?"新增环境":"编辑环境",visible:e.visible,"close-on-click-modal":!1,"before-close":e.onCancel,"append-to-body":!0}},[n("el-form",{ref:"form",attrs:{model:e.form}},[n("el-form-item",{attrs:{label:"名称","label-width":"120px",prop:"env_name",rules:e.rules.env_name,error:e.error.env_name}},[n("el-input",{attrs:{size:"small","auto-complete":"off"},model:{value:e.form.env_name,callback:function(t){e.$set(e.form,"env_name",t)},expression:"form.env_name"}})],1)],1),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.onOk}},[e._v("确定")]),e._v(" "),n("el-button",{attrs:{size:"small"},on:{click:e.onCancel}},[e._v("取消")])],1)],1)},staticRenderFns:[]};var v={name:"project-environment",components:{addEnvironmentDialog:n("VU/8")(m,d,!1,function(e){n("/8b3")},null,null).exports},data:function(){return{enableCreate:!1,value:"",columns:function(){var e=this;return[{label:"名称",width:250,prop:"env_name"},{label:"状态",width:250,prop:"status",render:function(e,t){return c[t.row.status]}},{label:"空间",width:250,prop:"space_name"},{label:"操作",minWidth:200,render:function(t,n,r){return e.renderTools(n)}}]}.call(this),currentEditEnvironment:null,addEnvironmentDialogVisible:!1}},watch:{value:function(){this.search()}},methods:{callServe:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.$refs.table;return s()(a.a.mark(function n(){var r,i,o,l,s;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(u.c)({size:t.page.size,page:t.page.currentPage,kw:e.value});case 2:r=n.sent,i=r.data,o=i.list,l=i.count,s=i.enable_create,e.enableCreate=s,t.page.total=l,t.list=o;case 10:case"end":return n.stop()}},n,e)}))()},search:function(){this.callServe()},addEnvironment:function(){this.addEnvironmentDialogVisible=!0,this.currentEditEnvironment=null},edit:function(e){this.addEnvironmentDialogVisible=!0,this.currentEditEnvironment=i()({},e)},delete:function(e){var t=this;this.$confirm("确定删除该环境吗? 删除后下属的项目及任务将不可见。","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.deletEenvironment(e)}).catch(function(){})},deletEenvironment:function(e){var t=this;return s()(a.a.mark(function n(){return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(u.b)(e.id);case 2:t.callServe(),t.$message({type:"success",message:"删除成功!"});case 4:case"end":return n.stop()}},n,t)}))()},confirm:function(e){this.currentEditEnvironment=null,this.callServe()},close:function(){this.currentEditEnvironment=null},renderEditTool:function(e){var t=this,n=this.$createElement;return e.enable_update?n("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-edit"},on:{click:function(){return t.edit(i()({},e))}}},["编辑"]):null},renderDeleteTool:function(e){var t=this,n=this.$createElement;return e.enable_delete?n("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-delete"},class:"user-delete",on:{click:function(){return t.delete(i()({},e))}}},["删除"]):null},renderTools:function(e){return(0,this.$createElement)("div",[this.renderEditTool(e.row),this.renderDeleteTool(e.row)])}}},f={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"wl-environment"},[n("el-form",{attrs:{inline:!0},nativeOn:{submit:function(e){e.preventDefault()}}},[n("el-form-item",[n("el-input",{staticClass:"search",attrs:{placeholder:"请输入内容",size:"small"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},[n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"})],1)],1),e._v(" "),e.enableCreate?n("el-form-item",[n("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:e.addEnvironment}},[e._v("添加")])],1):e._e()],1),e._v(" "),n("wl-table",{ref:"table",attrs:{columns:e.columns},on:{callServe:e.callServe}}),e._v(" "),n("add-environment-dialog",{attrs:{visible:e.addEnvironmentDialogVisible,environment:e.currentEditEnvironment},on:{"update:visible":function(t){e.addEnvironmentDialogVisible=t},confirm:e.confirm,close:e.close}})],1)},staticRenderFns:[]};var p=n("VU/8")(v,f,!1,function(e){n("lVJ6")},null,null);t.default=p.exports}});