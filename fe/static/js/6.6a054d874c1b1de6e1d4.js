webpackJsonp([6],{"2n+L":function(e,t,r){"use strict";t.d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n.b)("server/",e,{isRemoveField:!0,target:".wl-table"})},t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n.c)("server/",e,{headers:{"content-type":"multipart/form-data"},transformRequest:[function(e){return i.a.stringify(e)}]})},t.e=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(n.d)("server/"+e,t,{target:".wl-table",headers:{"content-type":"multipart/form-data"},transformRequest:[function(e){return i.a.stringify(e)}]})},t.b=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(n.a)("server/"+e,t)},t.c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(n.b)("server/"+e,t,{isLoading:!1})};var n=r("diZN"),o=r("mw3O"),i=r.n(o)},"6k9j":function(e,t){},"7vJ7":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("Dd8w"),o=r.n(n),i=r("Xxa5"),a=r.n(i),s=r("exGp"),l=r.n(s),c=r("2n+L"),u={props:{visible:{type:Boolean,default:!1},server:Object},data:function(){return{error:this.initError(),form:this.initForm(),rules:{name:[{required:!0,message:"请输入服务器名称",trigger:"blur"}],host:[{required:!0,message:"请输入服务器ip",trigger:"blur"}],user:[{required:!0,message:"请输入user",trigger:"blur"}],port:[{required:!0,message:"请输入port",trigger:"blur"}]}}},watch:{visible:function(e){var t=this;return l()(a.a.mark(function r(){var n,o,i,s,l,u;return a.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!e){r.next=15;break}if(!t.server){r.next=13;break}return r.next=4,Object(c.c)(t.server.id);case 4:n=r.sent,o=n.data,i=o.host,s=o.name,l=o.port,u=o.user,t.form={port:l||22,user:u,name:s,host:i},r.next=14;break;case 13:t.form=t.initForm();case 14:t.$nextTick(function(){t.$refs.form&&t.$refs.form.clearValidate()});case 15:case"end":return r.stop()}},r,t)}))()}},computed:{isNew:function(){return!this.server}},methods:{onOk:function(){var e=this;this.$refs.form.validate(function(t){if(!t)return!1;e.sendData()})},onCancel:function(){this.$emit("update:visible"),this.$emit("close")},initForm:function(){return{name:"",host:"",port:22,user:""}},initError:function(){return{name:"",host:"",port:"",user:""}},sendData:function(){var e=this;return l()(a.a.mark(function t(){var r,n;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.error=e.initError(),t.t0=e.isNew,!t.t0){t.next=6;break}return t.next=6,Object(c.a)(e.form);case 6:if(t.t1=e.isNew,t.t1){t.next=10;break}return t.next=10,Object(c.e)(e.server.id,e.form);case 10:e.$emit("update:visible"),e.$emit("confirm"),t.next=19;break;case 14:if(t.prev=14,t.t2=t.catch(0),t.t2.code,r=t.t2.message)for(n in r)e.error[n]=r[n][0];case 19:case"end":return t.stop()}},t,e,[[0,14]])}))()}}},f={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{staticClass:"wl-add-server",attrs:{width:"600px",title:e.isNew?"新增服务器":"编辑服务器",visible:e.visible,"close-on-click-modal":!1,"before-close":e.onCancel,"append-to-body":!0}},[r("el-form",{ref:"form",attrs:{model:e.form}},[r("el-form-item",{attrs:{label:"名称","label-width":"120px",prop:"name",rules:e.rules.name,error:e.error.name}},[r("el-input",{attrs:{size:"small","auto-complete":"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"host","label-width":"120px",prop:"host",rules:e.rules.host,error:e.error.host}},[r("el-input",{attrs:{size:"small","auto-complete":"off"},model:{value:e.form.host,callback:function(t){e.$set(e.form,"host",t)},expression:"form.host"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"ssh user","label-width":"120px",prop:"user",rules:e.rules.user,error:e.error.user}},[r("el-input",{attrs:{size:"small","auto-complete":"off"},model:{value:e.form.user,callback:function(t){e.$set(e.form,"user",t)},expression:"form.user"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"ssh port","label-width":"120px",prop:"port",rules:e.rules.port,error:e.error.port}},[r("el-input",{attrs:{size:"small","auto-complete":"off"},model:{value:e.form.port,callback:function(t){e.$set(e.form,"port",t)},expression:"form.port"}})],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.onOk}},[e._v("确定")]),e._v(" "),r("el-button",{attrs:{size:"small"},on:{click:e.onCancel}},[e._v("取消")])],1)],1)},staticRenderFns:[]};var d={name:"project-environment",components:{addServerDialog:r("VU/8")(u,f,!1,function(e){r("gWop")},null,null).exports},data:function(){return{enableCreate:!1,value:"",columns:function(){var e=this;return[{label:"名称",width:250,prop:"name"},{label:"IP",width:250,prop:"host"},{label:"操作",minWidth:200,render:function(t,r,n){return e.renderTools(r)}}]}.call(this),currentEditServer:null,addServerDialogVisible:!1}},watch:{value:function(){this.search()}},methods:{callServe:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.$refs.table;return l()(a.a.mark(function r(){var n,o,i,s,l;return a.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(c.d)({size:t.page.size,page:t.page.currentPage,kw:e.value});case 2:n=r.sent,o=n.data,i=o.list,s=o.count,l=o.enable_create,e.enableCreate=l,t.page.total=s,t.list=i;case 10:case"end":return r.stop()}},r,e)}))()},search:function(){this.callServe()},addServer:function(){this.addServerDialogVisible=!0,this.currentEditServer=null},edit:function(e){this.addServerDialogVisible=!0,this.currentEditServer=o()({},e)},delete:function(e){var t=this;this.$confirm("确定删除该服务器吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.deletEenvironment(e)}).catch(function(){})},deletEenvironment:function(e){var t=this;return l()(a.a.mark(function r(){return a.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(c.b)(e.id);case 2:t.callServe(),t.$message({type:"success",message:"删除成功!"});case 4:case"end":return r.stop()}},r,t)}))()},confirm:function(e){this.currentEditServer=null,this.callServe()},close:function(){this.currentEditServer=null},renderEditTool:function(e){var t=this,r=this.$createElement;return e.enable_update?r("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-edit"},on:{click:function(){return t.edit(o()({},e))}}},["编辑"]):null},renderDeleteTool:function(e){var t=this,r=this.$createElement;return e.enable_delete?r("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-delete"},class:"user-delete",on:{click:function(){return t.delete(o()({},e))}}},["删除"]):null},renderTools:function(e){return(0,this.$createElement)("div",[this.renderEditTool(e.row),this.renderDeleteTool(e.row)])}}},m={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"wl-server"},[r("el-form",{attrs:{inline:!0},nativeOn:{submit:function(e){e.preventDefault()}}},[r("el-form-item",[r("el-input",{staticClass:"search",attrs:{placeholder:"请输入内容",size:"small"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},[r("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"})],1)],1),e._v(" "),e.enableCreate?r("el-form-item",[r("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:e.addServer}},[e._v("添加")])],1):e._e()],1),e._v(" "),r("wl-table",{ref:"table",attrs:{columns:e.columns},on:{callServe:e.callServe}}),e._v(" "),r("add-server-dialog",{attrs:{visible:e.addServerDialogVisible,server:e.currentEditServer},on:{"update:visible":function(t){e.addServerDialogVisible=t},confirm:e.confirm,close:e.close}})],1)},staticRenderFns:[]};var v=r("VU/8")(d,m,!1,function(e){r("6k9j")},null,null);t.default=v.exports},gWop:function(e,t){}});